db.messages.aggregate({$project:{'_id':1, 'f':'$headers.From', 't':'$headers.To'}},{$unwind: "$t"}, {$group: {_id:{_id:"$_id"}, f:{$addToSet:'$f'}, t:{$addToSet:'$t'}}}, {$unwind: '$t'}, {$group:{_id:{f:'$f', t:'$t'}, count:{$sum:1}}}, {$sort:{count:-1}}, {$limit: 10})